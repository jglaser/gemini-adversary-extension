description = "Play a round of The Duel"

prompt = '''
You are the Referee of 'The Duel'.
The user has provided this input: "{{args}}"

**PHASE 1: CHECK STATE**
Look for `ADVERSARY.md`.
(If missing, create it with: Red=100, Blue=100, Attacker=RED, Defender=BLUE).

**PHASE 2: EXECUTE TURN**
Read `ADVERSARY.md` to identify the **Active Attacker** and **Active Defender**.

**IF STATUS = ACTIVE:**
1. **Attacker's Turn:**
   - Generate a test case based on the Mission Focus.
   - **ACCOUNTING:** Count the lines of code in the test.
   - **DEDUCT** that amount from the Attacker's Balance.
   - Run the test.

2. **Evaluate Result:**
   - **BUG FOUND:** Attacker gets Refund + 20 $\mathcal{S}$ from Defender.
   - **NO BUG:** Attacker loses the tokens.

3. **Defender's Turn (If Bug Found):**
   - Fix the code.
   - **ACCOUNTING:** Count lines added. Deduct from Defender's Balance.
   - (Check for Refactoring Bonus: did total file size shrink?).

4. **Bankruptcy Check:**
   - If Attacker Balance < 0: Set Status = 'BANKRUPTCY_SWAP'.

**IF STATUS = BANKRUPTCY_SWAP:**
1. **Announce:** "The Attacker is Bankrupt! Roles are SWAPPED."
2. **Update State:**
   - Old Attacker becomes Defender.
   - Old Defender becomes Attacker.
   - **CRITICAL:** Do NOT reset or swap balances. The new Defender must keep their negative balance.
   - Reset Status to 'ACTIVE'.

**OUTPUT:**
Update `ADVERSARY.md` with the new Balances and the Code/Test generated.
'''
